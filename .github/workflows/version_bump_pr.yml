name: Version Bump Merged

on:
  pull_request:
    types:
      - "closed"
    branches:
      - "main"

jobs:
  merge_job:
    # this job will only run if the PR has been merged and has the expected title
    if: github.event.pull_request.merged == true
    runs-on: ubuntu-latest
    steps:
      - run: |
          echo "A merged PR"
          echo "action_path: ${{ github.action_path }}"
          echo "actor: ${{ github.actor }}"
          echo "base_ref: ${{ github.base_ref }}"
          echo "github.event.pull_request.merged: ${{ github.event.pull_request.merged }}"
          echo "startsWith('bump_version_to_', github.head_ref): ${{ startsWith('bump_version_to_', github.head_ref) }}"
          echo "expression ${{ github.event.pull_request.merged == true && startsWith('bump_version_to_', github.head_ref) }}"
          echo "expression more ${{ github.event.pull_request.merged == true && startsWith('bump_version_to_', github.head_ref) == true }}"
          echo "event_name: ${{ github.event_name }}"
          echo "event_path: ${{ github.event_path }}"
          echo "head_ref: ${{ github.head_ref }}"
          echo "ref: ${{ github.ref }}"

          echo "Event"
          echo "action: ${{ github.event.action }}"
          echo "number: ${{ github.event.number }}"
          echo "installation: ${{ github.event.installation }}"
          echo "sender: ${{ toJSON(github.event.sender) }}"

          echo "Pull request"
          echo "${{ toJSON(github.event.pull_request) }}" > github.json

      - name: upload event details
        uses: actions/upload-artifact@v2
        with:
          name: event-details
          path: "github.json"
